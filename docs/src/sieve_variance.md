# Sieve Variance Plateau Estimation

If the i.i.d. (independent and identically distributed) hypothesis is not satisfied, most of the traditional statistical inference theory falls apart. This is typically possible in population genetics where a study may contain related individuals. Here we leverage a non-parametric method called [Sieve Variance Plateau](https://biostats.bepress.com/ucbbiostat/paper322/) (SVP) estimation. The hypothesis is that the dependence between individuals is sufficiently small, so that our targeted estimator will still be asymptotically unbiased, but its variance will be under estimated. In brief, the SVP estimator computes a variance estimate for a range of thresholds ùúè, by considering individuals to be independent if their distance exceeds ùúè. As the distance threshold ùúè increases, fewer individuals are assumed to be independent. The maximum of this curve is the most conservative estimate of the variance of the target parameter estimator and constitutes our SVP corrected variance estimator.

## Usage

At the moment, this script is restricted to the analysis of population genetics datasets mostly in the context of [TarGene](https://targene.github.io/targene-pipeline/stable/sieve_variance/). It can be run in the docker container described in [Run Environment](@ref) with the following command:

```bash
julia scripts/sieve_variance.jl PREFIX GRM_PREFIX OUT_PREFIX
        --nb-estimators=100
        --max-tau=1.0
        --verbosity=1
```

where:

- `PREFIX`: A prefix to HDF5 files generated by `scripts/tmle.jl` (potentially multiple).
- `GRM_PREFIX`: A prefix to the aggregated Genetic Relationship Matrix.
- `OUT_PREFIX`: Output prefix to save SVP curves and final variance estimates.
- `--nb-estimators`: The number of points per SVP curve.
- `--max-tau`: Maximum distance between individuals to consider.
- `--verbosity`: Verbosity level.